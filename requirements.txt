# =============================================================================
# MIA-RL / DDRL Requirements
# Generated from working conda env.
# Base: Python 3.10, CUDA 12.9.1 (module load cuda/12.9.1), GCC 13.4.0
# See adra_setup.sh for full install sequence (some packages need special flags)
# =============================================================================

# -----------------------------------------------------------------------------
# Core: PyTorch + CUDA
# -----------------------------------------------------------------------------
torch==2.8.0
torchvision==0.23.0
torchaudio==2.8.0
triton==3.4.0
numpy==2.2.6

# -----------------------------------------------------------------------------
# Inference & Attention
# NOTE: flash-attn must be installed with --no-build-isolation --no-cache-dir
# NOTE: transformer-engine via --extra-index-url https://pypi.nvidia.com --pre
# -----------------------------------------------------------------------------
vllm==0.11.0
flash_attn==2.8.3
transformer_engine==2.11.0
xformers==0.0.32.post1

# -----------------------------------------------------------------------------
# HuggingFace Ecosystem
# -----------------------------------------------------------------------------
transformers==4.57.6
accelerate==1.12.0
datasets==4.5.0
peft==0.17.1
tokenizers==0.22.2
huggingface-hub==0.36.0
hf-transfer==0.1.9
safetensors==0.7.0

# -----------------------------------------------------------------------------
# VERL (RL training framework â€” installed as editable: pip install --no-deps -e verl/)
# -----------------------------------------------------------------------------
# verl==0.4.0.dev0  # local editable install, see ddrl_setup.sh
ray==2.53.0
tensordict==0.10.0
torchdata==0.11.0
hydra-core==1.3.2
omegaconf==2.3.0
codetiming==1.4.0
pyarrow>=15.0.0
pandas==2.3.3
wandb==0.24.0
pybind11==3.0.1
pylatexenc==2.10
dill==0.4.0

# -----------------------------------------------------------------------------
# DDRL (TRL-based training)
# -----------------------------------------------------------------------------
trl==0.19.1
liger_kernel==0.6.4

# -----------------------------------------------------------------------------
# Custom Reward / Scoring
# -----------------------------------------------------------------------------
python-Levenshtein==0.27.3
rank-bm25==0.2.2
sentence-transformers==5.2.0

# -----------------------------------------------------------------------------
# Evaluation
# -----------------------------------------------------------------------------
math-verify==0.9.0
antlr4-python3-runtime==4.9.3
mathruler==0.1.0

# -----------------------------------------------------------------------------
# MIA
# -----------------------------------------------------------------------------
scikit-learn==1.7.2

# -----------------------------------------------------------------------------
# Metrics & Visualization
# -----------------------------------------------------------------------------
evaluate==0.4.6
seaborn==0.13.2
matplotlib==3.10.8

# -----------------------------------------------------------------------------
# Serving / API deps (pulled by vllm, pinned for reference)
# -----------------------------------------------------------------------------
fastapi==0.128.0
optree==0.18.0
pydantic>=2.9
grpcio>=1.62.1
nvidia-ml-py==13.590.48

# -----------------------------------------------------------------------------
# Vision / Multimodal
# -----------------------------------------------------------------------------
opencv-python==4.13.0.90
opencv-fixer==0.2.5
qwen-vl-utils==0.0.14

# -----------------------------------------------------------------------------
# Utilities
# -----------------------------------------------------------------------------
rich==14.2.0
scipy==1.15.3

# -----------------------------------------------------------------------------
# Dev Tools (optional)
# -----------------------------------------------------------------------------
pytest==9.0.2
py-spy==0.4.1
pre_commit==4.5.1
ruff==0.14.14
pyext==0.7
